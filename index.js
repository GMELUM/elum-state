import{useLayoutEffect as e,useRef as t,useState as s}from"react";const a={s:new Map,em:((e=new Map)=>({a:e,on:(t,s,a=e.get(t))=>a?a.push(s):e.set(t,[s]),off:(t,s,a=e.get(t))=>a&&s?a.splice(a.indexOf(s)>>>0,1):e.set(t,[]),emit:(t,s,a=e.get(t))=>a&&s&&a.slice().map((e=>e(s)))}))()},u=t=>{const[a,u]=s(t.get());return e((()=>t.sub(u)),[]),a},l=e=>t=>e.set(t),o=s=>{const a=t(s.get());return e((()=>s.sub((e=>{a.current=e}))),[]),a};export const atom=e=>({key:e.key,default:e.default,get:()=>a.s.get(e.key)??e.default,set:t=>{a.s.set(e.key,t),a.em.emit(e.key,t)},sub:t=>(a.em.on(e.key,t),()=>a.em.off(e.key,t))}),useGlobalValue=u,useSetGlobalState=l,useGlobalState=e=>[u(e),l(e)],useUnSubGlobalState=e=>[o(e),l(e)],useUnSubGlobalValue=o;